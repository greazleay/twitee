(this["webpackJsonptest-ts"]=this["webpackJsonptest-ts"]||[]).push([[0],{67:function(e,t,r){},68:function(e,t,r){},69:function(e,t,r){"use strict";r.r(t);var n=r(1),s=r(30),a=r.n(s),c=r(5),i=r(4),o=r(2),u=r.n(o),l=r(3),j=r(10),b=r(31),d=r.n(b),p=r(0),h=Object(n.createContext)(void 0),m=function(e){var t=e.children,r=function(){var e=Object(n.useState)(""),t=Object(j.a)(e,2),r=t[0],s=t[1],a=Object(n.useState)(""),c=Object(j.a)(a,2),i=c[0],o=c[1],b=Object(n.useState)(!1),p=Object(j.a)(b,2),h=p[0],m=p[1],O=Object(n.useState)({}),x=Object(j.a)(O,2),f=x[0],g=x[1],w=d.a.create({baseURL:"https://auth-svr.herokuapp.com/api/",headers:{Authorization:"Bearer ".concat(r)},timeout:15e3,withCredentials:!0}),v=function(){var e=Object(l.a)(u.a.mark((function e(t){var r,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,n=t.password,e.prev=1,m(!0),e.next=5,w.post("auth/login",{email:r,password:n});case 5:if(200===(a=e.sent).status){e.next=8;break}throw new Error("An error has occured");case 8:return s(a.data.authToken),m(!1),e.abrupt("return",!0);case 13:return e.prev=13,e.t0=e.catch(1),console.error(e.t0.message),o(e.t0.message),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.get("auth/logout");case 3:return s(""),e.abrupt("return",!0);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0.message),o(e.t0.message),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,m(!0),e.next=4,w.post("auth/token_renewal");case 4:if(200===(t=e.sent).status){e.next=7;break}throw new Error("An error has occured");case 7:return s(t.data.authToken),m(!1),e.abrupt("return",t.data.authToken);case 12:return e.prev=12,e.t0=e.catch(0),console.error(e.t0.message),o(e.t0.message),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(l.a)(u.a.mark((function e(t){var r,n,s,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,n=t.password,s=t.name,e.prev=1,e.next=4,w.post("auth/register",{email:r,password:n,name:s});case 4:if(200===(a=e.sent).status){e.next=7;break}throw new Error("An error has occured");case 7:return g(a.data.user),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(1),console.error(e.t0.message),o(e.t0.message),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,m(!0),e.next=4,w.get("user/userinfo");case 4:if(200===(t=e.sent).status){e.next=7;break}throw new Error("An error has occured");case 7:return g(t.data),m(!1),e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(0),console.error(e.t0.message),o(e.t0.message),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return w.interceptors.response.use((function(e){return e}),function(){var e=Object(l.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.config,!t.response){e.next=20;break}if(401!==t.response.status||r._retry){e.next=18;break}return r._retry=!0,e.prev=4,e.next=7,P();case 7:return n=e.sent,r.headers.Authorization="Bearer ".concat(n),w.defaults.headers.common.Authorization="Bearer ".concat(n),e.abrupt("return",w(r));case 13:if(e.prev=13,e.t0=e.catch(4),!e.t0.response||!e.t0.response.data){e.next=17;break}return e.abrupt("return",Promise.reject(e.t0.response.data));case 17:return e.abrupt("return",Promise.reject(e.t0));case 18:if(403!==t.response.status||!t.response.data){e.next=20;break}return e.abrupt("return",Promise.reject(t.response.data));case 20:return e.abrupt("return",Promise.reject(t));case 21:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}()),{authToken:r,user:f,isError:i,isLoading:h,login:v,logout:N,register:k,getUser:S,refreshToken:P}}();return Object(p.jsx)(h.Provider,{value:r,children:t})},O=function(){return Object(n.useContext)(h)},x=function(){var e=O().logout;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(c.b,{to:"/page-one",children:Object(p.jsx)("button",{children:"Page 1"})}),Object(p.jsx)(c.b,{to:"/page-two",children:Object(p.jsx)("button",{children:"Page 2"})}),Object(p.jsx)("button",{onClick:function(){e()},children:"Sign Out"})]})},f=function(){var e=O().authToken;return Object(p.jsxs)("nav",{className:"nav",children:[Object(p.jsx)(c.b,{to:"/members-only",children:Object(p.jsx)("button",{children:"Home"})}),Object(p.jsx)(c.b,{to:"/signin",children:Object(p.jsx)("button",{children:"Sign In"})}),Object(p.jsx)(c.b,{to:"/signup",children:Object(p.jsx)("button",{children:"Sign Up"})}),e&&Object(p.jsx)(x,{})]})},g=function(){return Object(p.jsx)("footer",{style:{width:"100%",height:"100%",flex:"1 1 0",textAlign:"center"},children:Object(p.jsx)("p",{children:"\xa9 2021 Pollaroid All rights reserved"})})},w=function(){return Object(p.jsxs)("main",{className:"main",children:[Object(p.jsx)("p",{children:"Home Page"}),Object(p.jsx)(c.b,{to:"/page-one",className:"App-link",children:"Protected Page 1"}),Object(p.jsx)(c.b,{to:"/page-two",className:"App-link",children:"Protected Page 2"})]})},v=r(9),N=r(34),P=["children"],k=function(e){var t=e.children,r=Object(N.a)(e,P),n=O().authToken;return Object(p.jsx)(i.b,Object(v.a)(Object(v.a)({},r),{},{render:function(e){var r=e.location;return n?t:Object(p.jsx)(i.a,{to:{pathname:"signin",state:{from:r}}})}}))},S=function(){return Object(p.jsxs)("main",{className:"main",children:[Object(p.jsx)("p",{children:"Page 1"}),Object(p.jsx)(c.b,{to:"/page-two",children:Object(p.jsx)("button",{children:"Next Page"})})]})},A=function(){var e=O(),t=e.getUser,r=e.isLoading,s=e.refreshToken,a=e.user;return Object(n.useEffect)((function(){Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()}),[]),Object(p.jsxs)("main",{className:"main",children:[Object(p.jsx)("p",{children:"Page 2"}),Object(p.jsx)(c.b,{to:"/page-one",children:Object(p.jsx)("button",{children:"Previous Page"})}),Object(p.jsx)("button",{onClick:s,children:"Get New Token"}),r?Object(p.jsx)("h2",{children:"LOADING..."}):Object(p.jsxs)("div",{children:[Object(p.jsx)("p",{children:null===a||void 0===a?void 0:a.name}),Object(p.jsx)("p",{children:null===a||void 0===a?void 0:a.email}),Object(p.jsx)("img",{src:null===a||void 0===a?void 0:a.avatar,alt:""})]})]})},E=r(17),y=function(){var e=Object(E.a)(),t=e.register,r=e.handleSubmit,n=e.formState.errors,s=e.getValues,a=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t,"Filled");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)("main",{className:"main",children:Object(p.jsxs)("form",{className:"form",onSubmit:r(a),children:[Object(p.jsx)("h1",{className:"form-title",children:"Sign up"}),Object(p.jsxs)("fieldset",{className:"fieldset",children:[Object(p.jsx)("input",Object(v.a)({className:"input",placeholder:"Full Name"},t("name",{required:"NAME REQUIRED",minLength:1}))),Object(p.jsx)("label",{className:"label",htmlFor:"name",children:"Name"}),n.name&&Object(p.jsx)("p",{children:n.name.message})]}),Object(p.jsxs)("fieldset",{className:"fieldset",children:[Object(p.jsx)("input",Object(v.a)({type:"email",className:"input",placeholder:"Emaiil Address"},t("email",{required:"PLEASE ENTER A VALID EMAIL"}))),Object(p.jsx)("label",{className:"label",htmlFor:"email",children:"Email"}),n.email&&Object(p.jsx)("p",{children:n.email.message})]}),Object(p.jsxs)("fieldset",{className:"fieldset",children:[Object(p.jsx)("input",Object(v.a)({className:"input",type:"password",placeholder:"Enter your Password"},t("password",{required:"YOU MUST SPECIFY A PASSWORD",minLength:{value:6,message:"Password must be at least 6 characters"}}))),Object(p.jsx)("label",{className:"label",htmlFor:"password",children:"Password"}),n.password&&Object(p.jsx)("p",{children:n.password.message})]}),Object(p.jsxs)("fieldset",{className:"fieldset",children:[Object(p.jsx)("input",Object(v.a)({className:"input",type:"password",placeholder:"Confirm password"},t("confirmPassword",{required:"PLEASE CONFIRM YOUR PASSWORD",validate:{matchesPreviousPassword:function(e){return s().password===e||"PASSWORDS MUST MATCH!"}}}))),Object(p.jsx)("label",{className:"label",htmlFor:"password",children:"Confirm Password"}),n.confirmPassword&&Object(p.jsx)("p",{children:n.confirmPassword.message})]}),Object(p.jsx)("button",{className:"submitBtn",type:"submit",children:"Create"})]})})},T=(r(67),function(){var e=Object(E.a)(),t=e.register,r=e.handleSubmit,n=e.formState.errors,s=O(),a=s.authToken,c=s.isLoading,o=s.login,j=(Object(i.g)(),function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return a?Object(p.jsx)(i.a,{to:"members-only"}):Object(p.jsx)("main",{className:"main",children:Object(p.jsxs)("form",{className:"form",onSubmit:r(j),children:[Object(p.jsx)("h1",{className:"form-title",children:"Sign In"}),Object(p.jsxs)("fieldset",{className:"fieldset",children:[Object(p.jsx)("input",Object(v.a)({type:"email",className:"input",placeholder:"Emaiil Address"},t("email",{required:"PLEASE ENTER A VALID EMAIL"}))),Object(p.jsx)("label",{className:"label",htmlFor:"email",children:"Email"}),n.email&&Object(p.jsx)("p",{children:n.email.message})]}),Object(p.jsxs)("fieldset",{className:"fieldset",children:[Object(p.jsx)("input",Object(v.a)({className:"input",type:"password",placeholder:"Enter your Password"},t("password",{required:"YOU MUST SPECIFY A PASSWORD",minLength:{value:6,message:"Password must be at least 6 characters"}}))),Object(p.jsx)("label",{className:"label",htmlFor:"password",children:"Password"}),n.password&&Object(p.jsx)("p",{children:n.password.message})]}),Object(p.jsx)("button",{className:"submitBtn",type:"submit",children:c?"Please wait..":"Sign In"})]})})}),L=function(){return Object(p.jsx)(c.a,{children:Object(p.jsx)(m,{children:Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)(f,{}),Object(p.jsxs)(i.d,{children:[Object(p.jsx)(i.b,{exact:!0,path:"/signin",children:Object(p.jsx)(T,{})}),Object(p.jsx)(i.b,{exact:!0,path:"/signup",children:Object(p.jsx)(y,{})}),Object(p.jsx)(i.b,{exact:!0,path:"/members-only",children:Object(p.jsx)(w,{})}),Object(p.jsxs)(k,{children:[Object(p.jsx)(i.b,{exact:!0,path:"/page-one",children:Object(p.jsx)(S,{})}),Object(p.jsx)(i.b,{exact:!0,path:"/page-two",children:Object(p.jsx)(A,{})})]}),Object(p.jsx)(i.a,{to:"/login"})]}),Object(p.jsx)(g,{})]})})})};r(68);a.a.render(Object(p.jsx)(L,{}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.a1033071.chunk.js.map